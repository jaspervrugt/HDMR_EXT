function C = hermite(m,d)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                                                                         %
%  HHH   HHH DDDDDDDD  MMM    MMM RRRRRRR    EEEEEEEE XXX   XXX TTTTTTTTT %
%  HHH   HHH DDDDDDDDD MMM    MMM RRRRRRRR   EEEEEEEE XXX   XXX TTTTTTTTT %
%  HHH   HHH DDD   DDD MMM    MMM RRR   RRR  EEE       XXX XXX  TT TTT TT %
%  HHH   HHH DDD   DDD MMMM  MMMM RRR   RRR  EEE       XXX XXX  T  TTT  T %
%  HHHHHHHHH DDD   DDD MMMMMMMMMM RRRRRRRR   EEEEEE     XXXXX      TTT    %
%  HHHHHHHHH DDD   DDD MMMMMMMMMM RRRRRRR    EEEEEE     XXXXX      TTT    %
%  HHH   HHH DDD   DDD MMM    MMM RRRRRRR    EEE       XXX XXX     TTT    %
%  HHH   HHH DDD   DDD MMM    MMM RRR  RRR   EEE       XXX XXX     TTT    %
%  HHH   HHH DDDDDDDDD MMM    MMM RRR   RRR  EEEEEEEE XXX   XXX    TTT    %
%  HHH   HHH DDDDDDDD  MMM    MMM RRR   RRR  EEEEEEEE XXX   XXX    TTT    %
%                                                                         %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Returns the value of a mth degree hermite polynomial at x. This         %
% function is much faster than built-in hermiteH(m,x) function. But for   %
% orders larger than m = 12 both functions start to deviate               %
%                                                                         %
%  SYNOPSIS                                                               %
%   C = hermite(m,d)                                                      %
%                                                                         %
%  Â© Written by Jasper A. Vrugt & Abdullah Sahin, Jan. 2018               %
%    University of California Irvine                                      %
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% %

C = zeros(m,m+1);
switch m
    case 1
        p = [ 2 0 ];
    case 2
        p = [ 2 0 0; 4 0 -2 ];
    case 3
        p = [ 2 0 0 0; 4 0 -2 0; 8 0 -12 0 ];
    case 4
        p = [ 2 0 0 0 0; 4 0 -2 0 0; 8 0 -12 0 0; 16 0 -48 0 12 ];
    case 5
        p = [ 2 0 0 0 0 0; 4 0 -2 0 0 0; 8 0 -12 0 0 0 ; ...
            16 0 -48 0 12 0 ; 32 0 -160 0 120 0 ];
    case 6
        p = [ 2 0 0 0 0 0 0; 4 0 -2 0 0 0 0; 8 0 -12 0 0 0 0; ...
            16 0 -48 0 12 0 0; 32 0 -160 0 120 0 0; 64 0 -480 0 720 0 -120 ];
    case 7
        p = [ 2 0 0 0 0 0 0 0; 4 0 -2 0 0 0 0 0; 8 0 -12 0 0 0 0 0; ...
            16 0 -48 0 12 0 0 0; 32 0 -160 0 120 0 0 0;...
            64 0 -480 0 720 0 -120 0; 128 0 -1344 0  3360 0 -1680 0 ];
    case 8
        p = [ 2 0 0 0 0 0 0 0 0; 4 0 -2 0 0 0 0 0 0; 8 0 -12 0 0 0 0 0 0; ...
            16 0 -48 0 12 0 0 0 0; 32 0 -160 0 120 0 0 0 0;...
            64 0 -480 0 720 0 -120 0 0; 128 0 -1344 0  3360 0 -1680 0 0; 256 0 -3584 0 13440 0 -13440 0 1680 ];
    case 9
        p = [ 2 0 0 0 0 0 0 0 0 0; 4 0 -2 0 0 0 0 0 0 0; 8 0 -12 0 0 0 0 0 0 0; ...
            16 0 -48 0 12 0 0 0 0 0; 32 0 -160 0 120 0 0 0 0 0;...
            64 0 -480 0 720 0 -120 0 0 0; 128 0 -1344 0  3360 0 -1680 0 0 0;...
            256 0 -3584 0 13440 0 -13440 0 1680 0; 512 0 -9216 0 48384 0 -80640 0 30240 0 ];
    case 10
        p = [ 2 0 0 0 0 0 0 0 0 0 0; 4 0 -2 0 0 0 0 0 0 0 0; 8 0 -12 0 0 0 0 0 0 0 0; ...
            16 0 -48 0 12 0 0 0 0 0 0; 32 0 -160 0 120 0 0 0 0 0 0;...
            64 0 -480 0 720 0 -120 0 0 0 0; 128 0 -1344 0  3360 0 -1680 0 0 0 0;...
            256 0 -3584 0 13440 0 -13440 0 1680 0 0;...
            512 0 -9216 0 48384 0 -80640 0 30240 0 0; 1024 0 -23040 0 161280 0 -403200 0 302400 0 -30240 ];
    case 11
        p = [ 2 0 0 0 0 0 0 0 0 0 0 0; 4 0 -2 0 0 0 0 0 0 0 0 0; 8 0 -12 0 0 0 0 0 0 0 0 0; ...
            16 0 -48 0 12 0 0 0 0 0 0 0; 32 0 -160 0 120 0 0 0 0 0 0 0;...
            64 0 -480 0 720 0 -120 0 0 0 0 0; 128 0 -1344 0  3360 0 -1680 0 0 0 0 0;...
            256 0 -3584 0 13440 0 -13440 0 1680 0 0 0;...
            512 0 -9216 0 48384 0 -80640 0 30240 0 0 0; 1024 0 -23040 0 161280 0 -403200 0 302400 0 -30240 0;...
            2048 0 -56320 0 506880 0 -1774080 0 2217600 0 -665280 0 ];
    case 12
        p = [ 2 0 0 0 0 0 0 0 0 0 0 0 0; 4 0 -2 0 0 0 0 0 0 0 0 0 0; 8 0 -12 0 0 0 0 0 0 0 0 0 0; ...
            16 0 -48 0 12 0 0 0 0 0 0 0 0; 32 0 -160 0 120 0 0 0 0 0 0 0 0;...
            64 0 -480 0 720 0 -120 0 0 0 0 0 0; 128 0 -1344 0  3360 0 -1680 0 0 0 0 0 0;...
            256 0 -3584 0 13440 0 -13440 0 1680 0 0 0 0;...
            512 0 -9216 0 48384 0 -80640 0 30240 0 0 0 0;...
            1024 0 -23040 0 161280 0 -403200 0 302400 0 -30240 0 0;...
            2048 0 -56320 0 506880 0 -1774080 0 2217600 0 -665280 0 0;...
            4096 0 -135168 0 1520640 0 -7096320 0 13305600 0 -7983360 0 665280 ];
end

for i = 1:d
    C(1:m,1:m+1,i) = p;
end

end